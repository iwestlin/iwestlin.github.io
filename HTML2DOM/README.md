code from [@iamamused](https://github.com/iamamused/foED-AdvancED-DOM-Scripting)